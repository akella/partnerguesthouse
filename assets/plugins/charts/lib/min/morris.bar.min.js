(function(){var t=function(t,o){return function(){return t.apply(o,arguments)}},o={}.hasOwnProperty,i=function(t,i){function r(){this.constructor=t}for(var s in i)o.call(i,s)&&(t[s]=i[s]);return r.prototype=i.prototype,t.prototype=new r,t.__super__=i.prototype,t};Morris.Bar=function(o){function r(o){return this.onHoverOut=t(this.onHoverOut,this),this.onHoverMove=t(this.onHoverMove,this),this.onGridClick=t(this.onGridClick,this),this instanceof Morris.Bar?(r.__super__.constructor.call(this,$.extend({},o,{parseTime:!1})),void 0):new Morris.Bar(o)}return i(r,o),r.prototype.init=function(){return this.cumulative=this.options.stacked,"always"!==this.options.hideHover?(this.hover=new Morris.Hover({parent:this.el}),this.on("hovermove",this.onHoverMove),this.on("hoverout",this.onHoverOut),this.on("gridclick",this.onGridClick)):void 0},r.prototype.defaults={barSizeRatio:.75,barGap:3,barColors:["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],xLabelMargin:50},r.prototype.calc=function(){var t;return this.calcBars(),this.options.hideHover===!1?(t=this.hover).update.apply(t,this.hoverContentForRow(this.data.length-1)):void 0},r.prototype.calcBars=function(){var t,o,i,r,s,n,e;for(n=this.data,e=[],t=r=0,s=n.length;s>r;t=++r)o=n[t],o._x=this.left+this.width*(t+.5)/this.data.length,e.push(o._y=function(){var t,r,s,n;for(s=o.y,n=[],t=0,r=s.length;r>t;t++)i=s[t],null!=i?n.push(this.transY(i)):n.push(null);return n}.call(this));return e},r.prototype.draw=function(){return this.options.axes&&this.drawXAxis(),this.drawSeries()},r.prototype.drawXAxis=function(){var t,o,i,r,s,n,e,h,a,l,p,u,d;for(l=this.bottom+this.options.padding/2,e=null,n=null,d=[],t=p=0,u=this.data.length;u>=0?u>p:p>u;t=u>=0?++p:--p)h=this.data[this.data.length-1-t],o=this.drawXAxisLabel(h._x,l,h.label),a=o.getBBox(),o.transform("r"+-this.options.xLabelAngle),i=o.getBBox(),o.transform("t0,"+i.height/2+"..."),0!==this.options.xLabelAngle&&(s=-.5*a.width*Math.cos(this.options.xLabelAngle*Math.PI/180),o.transform("t"+s+",0...")),(null==e||e>=i.x+i.width||null!=n&&n>=i.x)&&i.x>=0&&i.x+i.width<this.el.width()?(0!==this.options.xLabelAngle&&(r=1.25*this.options.gridTextSize/Math.sin(this.options.xLabelAngle*Math.PI/180),n=i.x-r),d.push(e=i.x-this.options.xLabelMargin)):d.push(o.remove());return d},r.prototype.drawSeries=function(){var t,o,i,r,s,n,e,h,a,l,p,u,d,c;return i=this.width/this.options.data.length,h=null!=this.options.stacked?1:this.options.ykeys.length,t=(i*this.options.barSizeRatio-this.options.barGap*(h-1))/h,e=i*(1-this.options.barSizeRatio)/2,c=this.ymin<=0&&this.ymax>=0?this.transY(0):null,this.bars=function(){var h,f,v,y;for(v=this.data,y=[],r=h=0,f=v.length;f>h;r=++h)a=v[r],s=0,y.push(function(){var h,f,v,y;for(v=a._y,y=[],l=h=0,f=v.length;f>h;l=++h)d=v[l],null!==d?(c?(u=Math.min(d,c),o=Math.max(d,c)):(u=d,o=this.bottom),n=this.left+r*i+e,this.options.stacked||(n+=l*(t+this.options.barGap)),p=o-u,this.options.stacked&&(u-=s),this.drawBar(n,u,t,p,this.colorFor(a,l,"bar")),y.push(s+=p)):y.push(null);return y}.call(this));return y}.call(this)},r.prototype.colorFor=function(t,o,i){var r,s;return"function"==typeof this.options.barColors?(r={x:t.x,y:t.y[o],label:t.label},s={index:o,key:this.options.ykeys[o],label:this.options.labels[o]},this.options.barColors.call(this,r,s,i)):this.options.barColors[o%this.options.barColors.length]},r.prototype.hitTest=function(t){return 0===this.data.length?null:(t=Math.max(Math.min(t,this.right),this.left),Math.min(this.data.length-1,Math.floor((t-this.left)/(this.width/this.data.length))))},r.prototype.onGridClick=function(t,o){var i;return i=this.hitTest(t,o),this.fire("click",i,this.options.data[i],t,o)},r.prototype.onHoverMove=function(t,o){var i,r;return i=this.hitTest(t,o),(r=this.hover).update.apply(r,this.hoverContentForRow(i))},r.prototype.onHoverOut=function(){return this.options.hideHover!==!1?this.hover.hide():void 0},r.prototype.hoverContentForRow=function(t){var o,i,r,s,n,e,h,a;for(r=this.data[t],o="<div class='morris-hover-row-label'>"+r.label+"</div>",a=r.y,i=e=0,h=a.length;h>e;i=++e)n=a[i],o+="<div class='morris-hover-point' style='color: "+this.colorFor(r,i,"label")+"'>\n  "+this.options.labels[i]+":\n  "+this.yLabelFormat(n)+"\n</div>";return"function"==typeof this.options.hoverCallback&&(o=this.options.hoverCallback(t,this.options,o)),s=this.left+(t+.5)*this.width/this.data.length,[o,s]},r.prototype.drawXAxisLabel=function(t,o,i){var r;return r=this.raphael.text(t,o,i).attr("font-size",this.options.gridTextSize).attr("font-family",this.options.gridTextFamily).attr("font-weight",this.options.gridTextWeight).attr("fill",this.options.gridTextColor)},r.prototype.drawBar=function(t,o,i,r,s){return this.raphael.rect(t,o,i,r).attr("fill",s).attr("stroke-width",0)},r}(Morris.Grid)}).call(this);